<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Szettek Kezel√©se - Cafe English Academy</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        /* Mock Mode Banner */
        .mock-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 12px 0;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
            z-index: 9999;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .mock-banner.active {
            display: block;
        }

        .mock-banner i {
            margin-right: 8px;
            vertical-align: middle;
        }

        /* Adjust body padding when mock banner is active */
        body.mock-mode-active {
            padding-top: 50px;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            width: 100%;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-title h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1e293b;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            color: #6366f1;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .back-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            transform: translateY(-1px);
        }

        .main-content {
            width: 100%;
            margin: 0;
            padding: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 16px 64px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .table-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .add-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .table th {
            background: rgba(99, 102, 241, 0.05);
            font-weight: 600;
            color: #475569;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table tr:hover {
            background: rgba(99, 102, 241, 0.03);
        }

        .class-name {
            font-weight: 600;
            color: #1e293b;
        }

        .teacher-name {
            color: #6366f1;
            font-weight: 500;
        }

        .set-name {
            font-weight: 600;
            color: #1e293b;
        }

        .set-description {
            color: #64748b;
            font-size: 14px;
            margin-top: 4px;
        }

        .students-count {
            color: #059669;
            font-weight: 600;
            text-align: center;
        }

        .difficulty-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .difficulty-A1 {
            background: rgba(34, 197, 94, 0.1);
            color: #059669;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .difficulty-A2 {
            background: rgba(16, 185, 129, 0.1);
            color: #047857;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .difficulty-B1 {
            background: rgba(251, 191, 36, 0.1);
            color: #d97706;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .difficulty-B2 {
            background: rgba(245, 158, 11, 0.1);
            color: #b45309;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .difficulty-C1 {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .difficulty-C2 {
            background: rgba(147, 51, 234, 0.1);
            color: #7c2d12;
            border: 1px solid rgba(147, 51, 234, 0.3);
        }

        .difficulty-none {
            display: none;
        }

        .actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn.view {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .action-btn.edit {
            background: rgba(251, 191, 36, 0.1);
            color: #f59e0b;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state i {
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .filter-select {
            padding: 10px 14px;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            font-size: 14px;
            color: #475569;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 16px;
            }

            .table-container {
                margin: 20px;
                padding: 20px;
            }

            .table {
                font-size: 14px;
            }

            .table th,
            .table td {
                padding: 12px 8px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Mock Mode Banner -->
    <div id="mockBanner" class="mock-banner">
        <i data-lucide="database"></i>
        <span>üé≠ DEMO √úZEMM√ìD AKT√çV - Csak bemutat√≥ adatok l√°that√≥ak</span>
    </div>

    <div class="header">
        <div class="header-content">
            <div class="header-title">
                <i data-lucide="layers" style="width: 32px; height: 32px; color: #6366f1;"></i>
                <h1>Szettek Kezel√©se</h1>
            </div>
            <a href="../admin-dashboard.html" class="back-btn">
                <i data-lucide="arrow-left" style="width: 16px; height: 16px;"></i>
                Vissza a Dashboard-ra
            </a>
        </div>
    </div>

    <div class="main-content">
        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>√ñsszes Szett</h3>
                <div class="stat-number">
                    <i data-lucide="layers" style="width: 24px; height: 24px; color: #6366f1;"></i>
                    <span id="totalSets">15</span>
                </div>
            </div>
            <div class="stat-card">
                <h3>Akt√≠v Csoportok</h3>
                <div class="stat-number">
                    <i data-lucide="users" style="width: 24px; height: 24px; color: #059669;"></i>
                    <span id="activeClasses">10</span>
                </div>
            </div>
            <div class="stat-card">
                <h3>Tan√°rok</h3>
                <div class="stat-number">
                    <i data-lucide="graduation-cap" style="width: 24px; height: 24px; color: #f59e0b;"></i>
                    <span id="totalTeachers">12</span>
                </div>
            </div>
            <div class="stat-card">
                <h3>√ñsszes Di√°k</h3>
                <div class="stat-number">
                    <i data-lucide="user-check" style="width: 24px; height: 24px; color: #8b5cf6;"></i>
                    <span id="totalStudents">186</span>
                </div>
            </div>
        </div>

        <!-- Sets Table -->
        <div class="table-container">
            <div class="table-header">
                <h2>
                    <i data-lucide="layers" style="width: 24px; height: 24px;"></i>
                    Szettek √Åttekint√©se
                </h2>
                <button class="add-btn" onclick="openAddSet()">
                    <i data-lucide="plus" style="width: 16px; height: 16px;"></i>
                    √öj Szett
                </button>
            </div>

            <!-- Search and Filters in one row -->
            <div class="search-and-filters" style="display: flex; gap: 12px; margin-bottom: 20px; align-items: center;">
                <!-- Szett keres√©s -->
                <div class="search-box" style="position: relative; flex: 1;">
                    <input type="text" id="setSearchInput" placeholder="Keres√©s szett n√©vben..." 
                           onkeyup="filterSets()" style="
                        width: 100%;
                        padding: 12px 16px;
                        padding-right: 40px;
                        border: 1px solid #e2e8f0;
                        border-radius: 8px;
                        font-size: 14px;
                        background: white;
                        outline: none;
                        transition: border-color 0.2s;
                    " onfocus="this.style.borderColor='#6366f1'" onblur="this.style.borderColor='#e2e8f0'">
                    <button onclick="clearSetSearch()" style="
                        position: absolute;
                        right: 8px;
                        top: 50%;
                        transform: translateY(-50%);
                        background: none;
                        border: none;
                        color: #6b7280;
                        cursor: pointer;
                        padding: 4px;
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    " onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='none'">
                        <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                    </button>
                </div>

                <!-- Csoport keres√©s -->
                <div class="search-box" style="position: relative; flex: 1;">
                    <input type="text" id="classSearchInput" placeholder="Keres√©s csoportban..." 
                           onkeyup="filterSets()" style="
                        width: 100%;
                        padding: 12px 16px;
                        padding-right: 40px;
                        border: 1px solid #e2e8f0;
                        border-radius: 8px;
                        font-size: 14px;
                        background: white;
                        outline: none;
                        transition: border-color 0.2s;
                    " onfocus="this.style.borderColor='#6366f1'" onblur="this.style.borderColor='#e2e8f0'">
                    <button onclick="clearClassSearch()" style="
                        position: absolute;
                        right: 8px;
                        top: 50%;
                        transform: translateY(-50%);
                        background: none;
                        border: none;
                        color: #6b7280;
                        cursor: pointer;
                        padding: 4px;
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    " onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='none'">
                        <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                    </button>
                </div>

                <!-- Tan√°r keres√©s -->
                <div class="search-box" style="position: relative; flex: 1;">
                    <input type="text" id="teacherSearchInput" placeholder="Keres√©s tan√°rban..." 
                           onkeyup="filterSets()" style="
                        width: 100%;
                        padding: 12px 16px;
                        padding-right: 40px;
                        border: 1px solid #e2e8f0;
                        border-radius: 8px;
                        font-size: 14px;
                        background: white;
                        outline: none;
                        transition: border-color 0.2s;
                    " onfocus="this.style.borderColor='#6366f1'" onblur="this.style.borderColor='#e2e8f0'">
                    <button onclick="clearTeacherSearch()" style="
                        position: absolute;
                        right: 8px;
                        top: 50%;
                        transform: translateY(-50%);
                        background: none;
                        border: none;
                        color: #6b7280;
                        cursor: pointer;
                        padding: 4px;
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    " onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='none'">
                        <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                    </button>
                </div>

                <!-- Di√°k keres√©s -->
                <div class="search-box" style="position: relative; flex: 1;">
                    <input type="text" id="studentSearchInput" placeholder="Keres√©s di√°kban..." 
                           onkeyup="filterSets()" style="
                        width: 100%;
                        padding: 12px 16px;
                        padding-right: 40px;
                        border: 1px solid #e2e8f0;
                        border-radius: 8px;
                        font-size: 14px;
                        background: white;
                        outline: none;
                        transition: border-color 0.2s;
                    " onfocus="this.style.borderColor='#6366f1'" onblur="this.style.borderColor='#e2e8f0'">
                    <button onclick="clearStudentSearch()" style="
                        position: absolute;
                        right: 8px;
                        top: 50%;
                        transform: translateY(-50%);
                        background: none;
                        border: none;
                        color: #6b7280;
                        cursor: pointer;
                        padding: 4px;
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    " onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='none'">
                        <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                    </button>
                </div>

                <!-- CEFR Szint filter -->
                <select class="filter-select" id="difficultyFilter" onchange="filterSets()">
                    <option value="">Minden Szint</option>
                    <option value="A1">A1 - Kezd≈ë</option>
                    <option value="A2">A2 - Elemi</option>
                    <option value="B1">B1 - K√∂z√©pfok</option>
                    <option value="B2">B2 - Fels≈ëfok</option>
                    <option value="C1">C1 - Halad√≥</option>
                    <option value="C2">C2 - Mesterfok</option>
                </select>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Csoport</th>
                        <th>Tan√°r</th>
                        <th>Szett Neve</th>
                        <th>Di√°kok</th>
                        <th>Szint</th>
                        <th>M≈±veletek</th>
                    </tr>
                </thead>
                <tbody id="setsTableBody">
                    <!-- Table content will be loaded here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Mock data for sets management with CEFR levels
        const setsData = [
            {
                id: 1,
                setName: "Business English Vocabulary",
                description: "Essential business terms and expressions",
                className: "Business English",
                teacherName: "Johnson Michael",
                studentsCount: 24,
                students: ["Alex Thompson", "Maria Garcia", "John Wilson", "Emma Brown", "David Lee", "Sarah Johnson", "Peter Smith", "Lisa Wang"],
                difficulty: "B2",
                cefrLevel: "B2",
                cardsCount: 85,
                lastUpdated: "2024-08-01"
            },
            {
                id: 2,
                setName: "IELTS Academic Writing",
                description: "Task 1 & 2 vocabulary and phrases",
                className: "IELTS Preparation",
                teacherName: "Smith Rebecca",
                studentsCount: 18,
                students: ["James Miller", "Anna Kowalski", "Michael Zhang", "Sophie Turner", "Robert Chen", "Julia Martinez", "Tom Anderson", "Nina Patel"],
                difficulty: "C1",
                cefrLevel: "C1",
                cardsCount: 62,
                lastUpdated: "2024-07-28"
            },
            {
                id: 3,
                setName: "Elementary Grammar A1-A2",
                description: "Basic grammar structures and rules",
                className: "Elementary A1-A2",
                teacherName: "Taylor Sarah",
                studentsCount: 32,
                students: ["Lucy Green", "Mark Davis", "Elena Rodriguez", "Paul Johnson", "Amy Chen", "Kevin O'Connor", "Sophia Kim", "Daniel Lopez", "Rachel Evans", "Carlos Silva"],
                difficulty: "A1",
                cefrLevel: "A1",
                cardsCount: 48,
                lastUpdated: "2024-07-25"
            },
            {
                id: 4,
                setName: "Advanced Conversation Topics",
                description: "Complex discussion topics and vocabulary",
                className: "Advanced English B2",
                teacherName: "Smith Rebecca",
                studentsCount: 16,
                students: ["Christopher Lee", "Isabella Clark", "Matthew Taylor", "Victoria Adams", "Oliver Thompson", "Charlotte Wilson"],
                difficulty: "B2",
                cefrLevel: "B2",
                cardsCount: 74,
                lastUpdated: "2024-08-02"
            },
            {
                id: 5,
                setName: "Everyday English Phrases",
                description: "Common phrases for daily situations",
                className: "Elementary A1-A2",
                teacherName: "Johnson Michael",
                studentsCount: 28,
                students: ["Gabriel Smith", "Mia Johnson", "Lucas Brown", "Ava Davis", "Benjamin Miller", "Emma Garcia", "Henry Wilson", "Olivia Martinez"],
                difficulty: "A2",
                cefrLevel: "A2",
                cardsCount: 56,
                lastUpdated: "2024-07-30"
            },
            {
                id: 6,
                setName: "Financial English",
                description: "Banking, investment, and finance vocabulary",
                className: "Business English",
                teacherName: "Johnson Michael",
                studentsCount: 22,
                students: ["Sebastian Anderson", "Amelia Thompson", "Alexander White", "Grace Harris", "William Clark", "Lily Lewis", "James Walker"],
                difficulty: "C1",
                cefrLevel: "C1",
                cardsCount: 68,
                lastUpdated: "2024-07-26"
            },
            {
                id: 7,
                setName: "Cambridge B2 Exam Prep",
                description: "Exam strategies and vocabulary",
                className: "Advanced English B2",
                teacherName: "Smith Rebecca",
                studentsCount: 20,
                difficulty: "B2",
                cefrLevel: "B2",
                cardsCount: 92,
                lastUpdated: "2024-08-03"
            },
            {
                id: 8,
                setName: "Travel English",
                description: "Useful phrases for travel and tourism",
                className: "Elementary A1-A2",
                teacherName: "Taylor Sarah",
                studentsCount: 26,
                difficulty: "A2",
                cefrLevel: "A2",
                cardsCount: 42,
                lastUpdated: "2024-07-29"
            },
            {
                id: 9,
                setName: "Intermediate Speaking Practice",
                description: "Conversation topics for intermediate learners",
                className: "Intermediate B1",
                teacherName: "Johnson Michael",
                studentsCount: 19,
                difficulty: "B1",
                cefrLevel: "B1",
                cardsCount: 65,
                lastUpdated: "2024-08-04"
            },
            {
                id: 10,
                setName: "Proficiency Vocabulary",
                description: "Advanced vocabulary for C2 level",
                className: "Proficiency Course",
                teacherName: "Smith Rebecca",
                studentsCount: 8,
                difficulty: "C2",
                cefrLevel: "C2",
                cardsCount: 95,
                lastUpdated: "2024-08-05"
            },
            {
                id: 11,
                setName: "Phrasal Verbs Collection",
                description: "Essential phrasal verbs for intermediate learners",
                className: "Intermediate B1",
                teacherName: "Taylor Sarah",
                studentsCount: 45,
                difficulty: "B1",
                cefrLevel: "B1",
                cardsCount: 120,
                lastUpdated: "2024-08-06"
            },
            {
                id: 12,
                setName: "Basic Vocabulary",
                description: "First words for absolute beginners",
                className: "Elementary A1-A2",
                teacherName: "Johnson Michael",
                studentsCount: 35,
                difficulty: "A1",
                cefrLevel: "A1",
                cardsCount: 30,
                lastUpdated: "2024-08-07"
            },
            {
                id: 13,
                setName: "Pronunciation & Grammar",
                description: "Combined pronunciation and grammar practice",
                className: "Intermediate B1",
                teacherName: "Smith Rebecca, Taylor Sarah",
                studentsCount: 22,
                difficulty: "B1",
                cefrLevel: "B1",
                cardsCount: 78,
                lastUpdated: "2024-08-08"
            },
            {
                id: 14,
                setName: "Academic Writing Skills",
                description: "University-level writing techniques",
                className: "Advanced Academic",
                teacherName: "Johnson Michael, Smith Rebecca, Taylor Sarah",
                studentsCount: 15,
                difficulty: "C1",
                cefrLevel: "C1",
                cardsCount: 115,
                lastUpdated: "2024-08-09"
            },
            {
                id: 15,
                setName: "Business Communication",
                description: "Professional communication in English",
                className: "Business Professional",
                teacherName: "Johnson Michael, Smith Rebecca",
                studentsCount: 18,
                difficulty: "B2",
                cefrLevel: "B2",
                cardsCount: 92,
                lastUpdated: "2024-08-10"
            }
        ];

        let filteredSets = [...setsData];

        function loadSetsTable() {
            // Ensure we're using current data
            syncDataWithMockMode();
            
            const tbody = document.getElementById('setsTableBody');
            
            if (filteredSets.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="empty-state">
                            <i data-lucide="layers" style="width: 48px; height: 48px;"></i>
                            <p>Nincsenek megjelen√≠thet≈ë szettek.</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredSets.map(set => `
                <tr>
                    <td>
                        <div class="class-name">${set.className}</div>
                    </td>
                    <td>
                        <div class="teacher-name">
                            ${set.teacherName}
                        </div>
                    </td>
                    <td>
                        <div class="set-name">${set.setName}</div>
                        <div class="set-description">${set.description}</div>
                        <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;">
                            ${set.cardsCount} k√°rtya ‚Ä¢ Friss√≠tve: ${set.lastUpdated}
                        </div>
                    </td>
                    <td>
                        <div class="students-count">
                            ${set.studentsCount}
                        </div>
                    </td>
                    <td>
                        <span class="difficulty-badge ${getDifficultyClass(set.difficulty)}">
                            ${getDifficultyText(set.difficulty)}
                        </span>
                    </td>
                    <td>
                        <div class="actions">
                            <button class="action-btn view" onclick="viewSet(${set.id})" title="Megtekint√©s">
                                <i data-lucide="eye" style="width: 14px; height: 14px;"></i>
                            </button>
                            <button class="action-btn edit" onclick="editSet(${set.id})" title="Szerkeszt√©s">
                                <i data-lucide="edit-3" style="width: 14px; height: 14px;"></i>
                            </button>
                            <button class="action-btn delete" onclick="deleteSet(${set.id})" title="T√∂rl√©s">
                                <i data-lucide="trash-2" style="width: 14px; height: 14px;"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');

            // Reinitialize icons
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        }

        function getDifficultyText(difficulty) {
            if (!difficulty) return '';
            
            const difficultyMap = {
                'A1': 'A1',
                'A2': 'A2', 
                'B1': 'B1',
                'B2': 'B2',
                'C1': 'C1',
                'C2': 'C2'
            };
            return difficultyMap[difficulty] || difficulty;
        }

        function getDifficultyClass(difficulty) {
            if (!difficulty) return 'difficulty-none';
            return `difficulty-${difficulty}`;
        }

        function filterSets() {
            const setSearchQuery = document.getElementById('setSearchInput').value.toLowerCase();
            const classSearchQuery = document.getElementById('classSearchInput').value.toLowerCase();
            const teacherSearchQuery = document.getElementById('teacherSearchInput').value.toLowerCase();
            const studentSearchQuery = document.getElementById('studentSearchInput').value.toLowerCase();
            const difficultyFilter = document.getElementById('difficultyFilter').value;

            const currentSetsData = getCurrentSetsData();
            filteredSets = currentSetsData.filter(set => {
                const matchesSetSearch = !setSearchQuery || 
                    set.setName.toLowerCase().includes(setSearchQuery) ||
                    set.description.toLowerCase().includes(setSearchQuery);
                
                const matchesClassSearch = !classSearchQuery || 
                    set.className.toLowerCase().includes(classSearchQuery);
                
                const matchesTeacherSearch = !teacherSearchQuery || 
                    set.teacherName.toLowerCase().includes(teacherSearchQuery);
                
                const matchesStudentSearch = !studentSearchQuery || 
                    (set.students && set.students.some(student => 
                        student.toLowerCase().includes(studentSearchQuery)
                    ));
                
                const matchesDifficulty = !difficultyFilter || set.difficulty === difficultyFilter;

                return matchesSetSearch && matchesClassSearch && matchesTeacherSearch && 
                       matchesStudentSearch && matchesDifficulty;
            });

            loadSetsTable();
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalSets').textContent = filteredSets.length;
            
            const uniqueClasses = new Set(filteredSets.map(set => set.className));
            document.getElementById('activeClasses').textContent = uniqueClasses.size;
            
            const uniqueTeachers = new Set(filteredSets.map(set => set.teacherName));
            document.getElementById('totalTeachers').textContent = uniqueTeachers.size;
            
            const totalStudents = filteredSets.reduce((sum, set) => sum + set.studentsCount, 0);
            document.getElementById('totalStudents').textContent = totalStudents;
        }

        function clearSetSearch() {
            document.getElementById('setSearchInput').value = '';
            filterSets();
        }

        function clearClassSearch() {
            document.getElementById('classSearchInput').value = '';
            filterSets();
        }

        function clearTeacherSearch() {
            document.getElementById('teacherSearchInput').value = '';
            filterSets();
        }

        function clearStudentSearch() {
            document.getElementById('studentSearchInput').value = '';
            filterSets();
        }

        function viewSet(id) {
            const set = setsData.find(s => s.id === id);
            if (set) {
                const cefrLevel = set.cefrLevel ? `CEFR szint: ${set.cefrLevel}` : 'CEFR szint: Nincs megadva';
                const studentsList = set.students ? `\n- Di√°kok: ${set.students.join(', ')}` : '';
                alert(`Szett megtekint√©se: ${set.setName}\n\nR√©szletek:\n- ${set.cardsCount} k√°rtya\n- ${set.studentsCount} di√°k\n- ${cefrLevel}\n- Csoport: ${set.className}\n- Tan√°r: ${set.teacherName}\n- Le√≠r√°s: ${set.description}${studentsList}\n- Utolj√°ra friss√≠tve: ${set.lastUpdated}`);
            }
        }

        function editSet(id) {
            const set = setsData.find(s => s.id === id);
            if (set) {
                alert(`Szett szerkeszt√©se: ${set.setName}\n\nEz a funkci√≥ hamarosan el√©rhet≈ë lesz!`);
            }
        }

        function deleteSet(id) {
            const set = setsData.find(s => s.id === id);
            if (set && confirm(`Biztosan t√∂r√∂lni szeretn√© a k√∂vetkez≈ë szettet?\n\n"${set.setName}"\n\nEz a m≈±velet nem vonhat√≥ vissza!`)) {
                const index = setsData.findIndex(s => s.id === id);
                if (index !== -1) {
                    setsData.splice(index, 1);
                    filterSets(); // Refresh the filtered data and table
                    alert(`"${set.setName}" szett sikeresen t√∂r√∂lve!`);
                }
            }
        }

        function openAddSet() {
            alert('√öj szett hozz√°ad√°sa funkci√≥ hamarosan el√©rhet≈ë lesz!');
        }

        // =============================================================================
        // MOCK MODE SYSTEM INTEGRATION
        // =============================================================================
        
        // Global Mock Mode State (synchronized with admin dashboard)
        let isMockMode = localStorage.getItem('snappyCards_mockMode') === 'true';
        
        // Mock data sets for sets management
        const mockSetsData = [
            {
                id: 301,
                setName: 'Business English Vocabulary DEMO',
                description: 'Demo flashcard set - Essential business terms and phrases',
                className: 'Advanced Business English B2+',
                teacherName: 'Sarah Wilson',
                studentsCount: 12,
                cardsCount: 45,
                difficulty: 'B2',
                cefrLevel: 'B2',
                lastUpdated: '2024-08-04',
                students: ['Michael Brown', 'Emma Davis', 'James Wilson', 'Sophie Taylor']
            },
            {
                id: 302,
                setName: 'IELTS Writing Task 1 DEMO',
                description: 'Demo flashcard set - IELTS Academic Writing vocabulary',
                className: 'IELTS Preparation Course',
                teacherName: 'James Martinez',
                studentsCount: 8,
                cardsCount: 38,
                difficulty: 'B2',
                cefrLevel: 'B2',
                lastUpdated: '2024-08-03',
                students: ['Anna Johnson', 'David Lee', 'Maria Garcia', 'Tom Anderson']
            },
            {
                id: 303,
                setName: 'Cambridge FCE Grammar DEMO',
                description: 'Demo flashcard set - First Certificate grammar patterns',
                className: 'FCE Preparation',
                teacherName: 'Emma Thompson',
                studentsCount: 15,
                cardsCount: 62,
                difficulty: 'B2',
                cefrLevel: 'B2',
                lastUpdated: '2024-08-02',
                students: ['Peter Johnson', 'Lisa Brown', 'Alex Green', 'Kate White', 'John Smith']
            }
        ];
        
        // Data access functions
        function getCurrentSetsData() {
            return isMockMode ? mockSetsData : setsData;
        }
        
        function updateMockModeUI() {
            const mockBanner = document.getElementById('mockBanner');
            const body = document.body;
            
            if (mockBanner) {
                if (isMockMode) {
                    mockBanner.classList.add('active');
                    body.classList.add('mock-mode-active');
                } else {
                    mockBanner.classList.remove('active');
                    body.classList.remove('mock-mode-active');
                }
                lucide.createIcons(mockBanner);
            }
        }
        
        // Override global variables with current data
        function syncDataWithMockMode() {
            const currentData = getCurrentSetsData();
            // Update filteredSets to use current data
            filteredSets = currentData.slice();
        }
        
        // Initialize Mock Mode on page load
        function initializeMockMode() {
            updateMockModeUI();
            syncDataWithMockMode();
            console.log(`üé≠ Sets Management Mock Mode: ${isMockMode ? 'ACTIVE' : 'DISABLED'}`);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeMockMode();
            loadSetsTable();
            updateStats();
            lucide.createIcons();
        });
    </script>
</body>
</html>